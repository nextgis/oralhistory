{"version":3,"sources":["webpack:///./nextgisweb_frontend/packages/vue-ngw-map/src/utils.ts","webpack:///./nextgisweb_frontend/packages/vue-ngw-map/src/components/VueNgwControl.ts","webpack:///./nextgisweb_frontend/packages/vue-ngw-map/src/components/VueNgwMapBase.ts","webpack:///./nextgisweb_frontend/packages/vue-ngw-map/src/components/VueNgwMapbox.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/preparePaint.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/geometryTypes.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/updateGeoJsonAdapterOptions.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/propertiesFilter.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/controls/ToggleControl.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/keys/KeysCodes.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/keys/Keys.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/decorators.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/mapStates/StateItem.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/mapStates/CenterState.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/components/mapStates/ZoomState.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/BaseWebMap.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/util/clearObject.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/WebMapLayers.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/WebMap.ts","webpack:///./nextgisweb_frontend/packages/webmap/src/index.ts"],"names":["capitalizeFirstLetter","str","charAt","toUpperCase","slice","name","beforeDestroy","this","parentContainer","ngwMap","control","removeControl","undefined","setControl","element","adControlOptions","$props","controlOptions","controlObject","onAdd","onRemove","createControl","_control","addControl","position","mounted","firstVueParent","found","$parent","findNgwMapParent","$el","vueElement","props","key","setMethodName","prop","deepValue","type","Object","Array","isArray","$watch","newVal","oldVal","deep","propsBinder","$nextTick","$emit","render","h","staticClass","staticStyle","attrs","$slots","default","String","Boolean","VueNgwControl","ready","_setNgwMap","destroy","zIndex","fullFilling","width","height","data","mapAdapter","mapOptions","target","Number","VueNgwMapBase","VueNgwMapbox","preparePaint","paint","defaultPaint","getPaintFunctions","newPaint","opt","getPaint","from","options","updatePaintOptionFromCallback","fill","stroke","strokeColor","strokeOpacity","color","fillColor","opacity","fillOpacity","findMostFrequentGeomType","arr","maxName","counts","fry","length","c","count","detectGeometryType","geojson","geometry","features","map","f","geometries","g","typeAlias","Point","LineString","MultiPoint","Polygon","MultiLineString","MultiPolygon","updateGeoJsonAdapterOptions","geomType","p","like","a","b","iLike","re","replace","RegExp","exec","operationsAliases","gt","lt","ge","le","eq","ne","in","indexOf","notin","ilike","propertiesFilter","properties","filters","every","field","operation","value","operationExec","property","createToggleControl","createButtonControl","link","document","createElement","status","getStatus","title","html","setTitle","on","off","setAttribute","_setHtml","htmlDef","HTMLElement","innerHTML","appendChild","setHtml","_setClass","addClass","impact","split","forEach","x","classList","add","remove","setClass","addClassOn","addClassOff","changeStatus","status_","onClick","afterClick","Promise","resolve","then","catch","buttonControl","keyCodeAlias","KeyCodes","keys","_windowOnFocus","windowOnFocus","bind","_keysPressed","keysPressed","_keysReleased","keysReleased","addKeyboardEventsListener","pressed","keyName","code","window","addEventListener","removeKeyboardEventsListener","removeEventListener","e","stopPropagation","keyCode","onLoad","event","_target","_propertyKey","descriptor","originalMethod","reject","_resolve","origin","apply","args","getEventStatus","emitter","once","webMap","setValue","getValue","val","getCenter","setCenter","toString","d","toFixed","parse","StateItem","getZoom","setZoom","OPTIONS","minZoom","maxZoom","radius","weight","selectedPaint","appOptions","BaseWebMap","runtimeParams","mapState","CenterState","ZoomState","_initMapState","_mapState","_eventsStatus","_mapEvents","_starterKits","starterKits","_addEventsListeners","create","_setInitMapState","_setupMap","_emitStatusEvent","setRuntimeParams","params","push","_removeEventsListeners","obj","member","clearObject","getState","state","getRuntimeParams","get","getContainer","getElementById","setCursor","cursor","lngLat","getBounds","zoom","setView","fitBounds","bounds","_eventName","res","onMapLoad","cb","isLoaded","getLayerAdapters","layerAdapters","getLayerAdapter","locate","events","stop","eventName","emit","_addLayerProviders","_onLoadSync","_zoomToInitialExtent","center","_extent","states","X","find","y","r","set","entries","utils","decorators","_layersIds","_baseLayers","_layers","_selectedLayers","fitLayer","layerDef","layer","getLayer","getExtent","extent","isBaseLayer","id","getBaseLayers","getLayerId","Error","getLayers","findLayer","filter","l","layerAdapter","isLayerVisible","visibility","addBaseLayer","adapter","addLayer","baseLayer","order","_order","adapterEngine","geoJsonOptions","_updateGeoJsonOptions","onBeforeAddLayer","modified","_adapter","layerId","filterLayer","showLayer","setLayerOpacity","fit","addLayerFromAsyncAdapter","removeLayers","allowCb","allow","removeLayer","removeOverlays","beforeRemove","index","splice","addGeoJsonLayer","multiselect","unselectOnSecondClick","toggleLayer","hideLayer","onMap","toStatus","silent","action","source","preEventName","anotherVisibleLayerBaseLayer","call","setLayerOrder","updateLayer","selectLayer","findFeatureFun","select","unSelectLayer","unselect","feature","removeLayerFilter","removeFilter","setLayerData","setData","clearLayer","addData","addLayerData","clearLayerData","getAttributions","attributions","layerMem","onlyVisible","attr","attribution","getActiveBaseLayer","visibleLayerBaseLayer","_onLayerClick","onLayerClickFromOpt","onLayerClick","nativePaint","WebMap","controlDef","getControl","engine","controlAdapters","createFun","controls","kit","adapters","createAdapter","newAdapter","onLoadSync","console","error","CONTROL","BUTTON","TOGGLE"],"mappings":"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","file":"main~5acb325d-1ef3d54.js","sourcesContent":["import Vue from 'vue';\nimport VueNgwMap from './components/VueNgwMapBase';\n\nexport const capitalizeFirstLetter = (str: string) => {\n  if (!str || typeof str.charAt !== 'function') {\n    return str;\n  }\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\ninterface VueElement extends Vue {\n  [prop: string]: any;\n}\n\nexport function propsBinder(\n  vueElement: VueElement,\n  props: Record<string, any>\n) {\n  for (const key in props) {\n    const setMethodName = 'set' + capitalizeFirstLetter(key);\n    if (key in props && vueElement[setMethodName]) {\n      const prop = props[key];\n      const deepValue =\n        (prop && prop.type === Object) ||\n        prop.type === Array ||\n        Array.isArray(prop.type);\n      vueElement.$watch(\n        key,\n        (newVal, oldVal) => {\n          vueElement[setMethodName](newVal, oldVal);\n        },\n        {\n          deep: deepValue\n        }\n      );\n    }\n  }\n}\n\nexport const findNgwMapParent = (\n  firstVueParent: Vue | VueNgwMap\n): VueNgwMap => {\n  let found = false;\n  while (firstVueParent && !found) {\n    if (!('ngwMap' in firstVueParent)) {\n      firstVueParent = firstVueParent.$parent;\n    } else {\n      found = true;\n    }\n  }\n  return firstVueParent as VueNgwMap;\n};\n","import Vue, { CreateElement, VNode, VNodeData } from 'vue';\nimport Component from 'vue-class-component';\nimport { Prop } from 'vue-property-decorator';\nimport {\n  MapControl,\n  CreateControlOptions,\n  ControlPositions\n} from '@nextgis/webmap';\nimport { findNgwMapParent, propsBinder } from '../utils';\nimport VueNgwMap from './VueNgwMapBase';\n\n@Component\nexport class VueNgwControl extends Vue {\n  name = 'vue-ngw-control';\n\n  @Prop({ type: String }) position!: ControlPositions;\n  @Prop({ type: Boolean }) bar!: boolean;\n  @Prop({ type: Boolean }) margin!: boolean;\n  @Prop({ type: String }) addClass!: string;\n  @Prop({ type: Object, default: () => ({}) })\n  controlOptions!: CreateControlOptions;\n\n  parentContainer!: VueNgwMap;\n\n  control?: unknown;\n\n  beforeDestroy() {\n    if (this.parentContainer.ngwMap && this.control) {\n      this.parentContainer.ngwMap.removeControl(this.control);\n      this.control = undefined;\n    }\n  }\n\n  async setControl(element: HTMLElement) {\n    const ngwMap = this.parentContainer.ngwMap;\n    const control = this.control;\n    if (ngwMap) {\n      if (control) {\n        ngwMap.removeControl(control);\n      }\n      const adControlOptions: CreateControlOptions = {\n        ...this.$props,\n        ...this.$props.controlOptions\n      };\n      const controlObject: MapControl = {\n        onAdd: () => {\n          return element;\n        },\n        onRemove: () => {\n          // ignore\n        }\n      };\n      const _control = await ngwMap.createControl(\n        controlObject,\n        adControlOptions\n      );\n      this.control = ngwMap.addControl(_control, this.position);\n    }\n  }\n\n  async mounted() {\n    this.parentContainer = findNgwMapParent(this.$parent);\n\n    await this.setControl(this.$el as HTMLElement);\n\n    propsBinder(this, this.$props);\n\n    this.$nextTick(() => {\n      this.$emit('ready', this.control);\n    });\n  }\n\n  render(h: CreateElement): VNode {\n    const staticStyle: { [param: string]: string } = {\n      // zIndex: '0'\n    };\n\n    const data: VNodeData = {\n      staticClass: 'vue-ngw-control',\n      staticStyle,\n      // 'class': this.classes,\n      attrs: { 'data-app': true }\n      // domProps: { id: this.id }\n    };\n\n    return h('div', data, this.$slots.default);\n  }\n}\n\nexport default VueNgwControl;\n","import Vue, { VNode, VNodeData, CreateElement } from 'vue';\nimport { Prop } from 'vue-property-decorator';\nimport Component from 'vue-class-component';\nimport NgwMap, { NgwMapOptions, MapAdapter } from '@nextgis/ngw-map';\n\nimport NgwConnector from '@nextgis/ngw-connector';\n\n@Component\nexport class VueNgwMapBase extends Vue {\n  @Prop({ type: Object }) mapAdapter!: MapAdapter;\n  @Prop({ type: Boolean }) fullFilling!: boolean;\n  @Prop({ type: NgwConnector }) connector!: NgwConnector;\n  @Prop({ type: String }) baseUrl!: string;\n  @Prop({ type: Number }) qmsId!: string;\n  @Prop({ type: String }) webMapId!: string;\n  @Prop({ type: Object }) mapOptions!: NgwMapOptions;\n  name = 'vue-ngw-map';\n  ngwMap!: NgwMap;\n  ready = false;\n\n  mounted() {\n    this._setNgwMap();\n  }\n\n  beforeDestroy() {\n    this.ngwMap.destroy();\n  }\n\n  render(h: CreateElement): VNode {\n    const staticStyle: { [param: string]: string } = {\n      zIndex: '0'\n    };\n    if (this.fullFilling) {\n      staticStyle.width = '100%';\n      staticStyle.height = '100%';\n    }\n\n    const data: VNodeData = {\n      staticClass: 'vue-ngw-map',\n      staticStyle,\n      // 'class': this.classes,\n      attrs: { 'data-app': true }\n      // domProps: { id: this.id }\n    };\n\n    return this.ready ? h('div', data, this.$slots.default) : h('div', data);\n  }\n\n  private _setNgwMap() {\n    this.ngwMap = new NgwMap(this.mapAdapter, {\n      ...this.$props,\n      ...this.mapOptions,\n      target: this.$el as HTMLElement\n    });\n    this.ready = true;\n  }\n}\n\nexport default VueNgwMapBase;\n","import 'mapbox-gl/dist/mapbox-gl.css';\n\nimport { Mixins, Prop } from 'vue-property-decorator';\nimport Component from 'vue-class-component';\nimport { VueNgwMapBase } from './VueNgwMapBase';\n\nimport MapAdapter from '@nextgis/mapboxgl-map-adapter';\n\n@Component\nexport class VueNgwMapbox extends Mixins(VueNgwMapBase) {\n  @Prop({ type: Object, default: () => new MapAdapter() }) mapAdapter!: MapAdapter;\n}\n","import {\n  Paint,\n  VectorAdapterLayerPaint,\n  GeometryPaint,\n  GetPaintFunction,\n  GetCustomPaintOptions\n} from '../interfaces/LayerAdapter';\n\nfunction updatePaintOptionFromCallback(\n  paint: GetCustomPaintOptions,\n  getPaintFunctions: { [name: string]: GetPaintFunction }\n): VectorAdapterLayerPaint | undefined {\n  if (typeof paint.from === 'function') {\n    return paint.from(paint.options);\n  } else if (typeof paint.from === 'string' && getPaintFunctions) {\n    const from = getPaintFunctions[paint.from];\n    if (from) {\n      return from(paint.options);\n    }\n  }\n}\n\nexport function preparePaint(\n  paint: Paint,\n  defaultPaint: GeometryPaint,\n  getPaintFunctions: { [name: string]: GetPaintFunction }\n): Paint {\n  let newPaint: Paint | undefined;\n  if (typeof paint === 'function') {\n    return (opt: any) => {\n      return preparePaint(\n        paint(opt),\n        defaultPaint,\n        getPaintFunctions\n      ) as VectorAdapterLayerPaint;\n    };\n  } else if (paint.type === 'get-paint') {\n    const getPaint = updatePaintOptionFromCallback(paint, getPaintFunctions);\n    if (getPaint) {\n      newPaint = preparePaint(getPaint, defaultPaint, getPaintFunctions);\n    }\n  } else if (paint.type === 'icon') {\n    return paint;\n  } else {\n    newPaint = { ...paint };\n    newPaint.fill = newPaint.fill !== undefined ? newPaint.fill : true;\n    newPaint.stroke =\n      newPaint.stroke !== undefined\n        ? newPaint.stroke\n        : !newPaint.fill || !!(newPaint.strokeColor || newPaint.strokeOpacity);\n  }\n  if (newPaint) {\n    if (typeof newPaint === 'function') {\n      return newPaint;\n    } else {\n      newPaint = { ...defaultPaint, ...newPaint };\n    }\n  } else {\n    newPaint = { ...defaultPaint };\n  }\n\n  if ('color' in newPaint) {\n    if (!newPaint.strokeColor) {\n      newPaint.strokeColor = newPaint.color;\n    }\n    if (!newPaint.fillColor) {\n      newPaint.fillColor = newPaint.color;\n    }\n  }\n  if ('opacity' in newPaint) {\n    if (newPaint.strokeOpacity === undefined) {\n      newPaint.strokeOpacity = newPaint.opacity;\n    }\n    if (newPaint.fillOpacity === undefined) {\n      newPaint.fillOpacity = newPaint.opacity;\n    }\n  }\n\n  return newPaint;\n}\n","import {\n  GeoJsonObject,\n  GeoJsonGeometryTypes,\n  FeatureCollection,\n  GeometryCollection,\n  Feature\n} from 'geojson';\n\nexport function findMostFrequentGeomType(\n  arr: GeoJsonGeometryTypes[]\n): GeoJsonGeometryTypes {\n  const counts: { [x: string]: number } = {};\n  for (let fry = 0; fry < arr.length; fry++) {\n    counts[arr[fry]] = 1 + (counts[arr[fry]] || 0);\n  }\n  let maxName;\n  for (const c in counts) {\n    const count = maxName !== undefined ? counts[maxName] : 0;\n    if (counts[c] > (count || 0)) {\n      maxName = c;\n    }\n  }\n  return maxName as GeoJsonGeometryTypes;\n}\n\nexport function detectGeometryType(\n  geojson: GeoJsonObject\n): GeoJsonGeometryTypes {\n  let geometry: GeoJsonGeometryTypes;\n  if (geojson.type === 'FeatureCollection') {\n    const featuresTypes = (geojson as FeatureCollection).features.map(\n      f => f.geometry.type\n    );\n    geometry = findMostFrequentGeomType(featuresTypes);\n  } else if (geojson.type === 'GeometryCollection') {\n    const geometryTypes = (geojson as GeometryCollection).geometries.map(\n      g => g.type\n    );\n    geometry = findMostFrequentGeomType(geometryTypes);\n  } else if (geojson.type === 'Feature') {\n    geometry = (geojson as Feature).geometry.type;\n  } else {\n    geometry = geojson.type;\n  }\n  return geometry;\n}\n","import {\n  GeoJsonAdapterOptions,\n  VectorAdapterLayerType\n} from '../interfaces/LayerAdapter';\nimport { detectGeometryType } from './geometryTypes';\n\nexport const typeAlias: { [x: string]: VectorAdapterLayerType } = {\n  Point: 'circle',\n  LineString: 'line',\n  MultiPoint: 'circle',\n  Polygon: 'fill',\n  MultiLineString: 'line',\n  MultiPolygon: 'fill'\n};\n\nexport function updateGeoJsonAdapterOptions(\n  opt: GeoJsonAdapterOptions\n): GeoJsonAdapterOptions {\n  if (opt.data) {\n    const geomType = typeAlias[detectGeometryType(opt.data)];\n    const p = opt.paint;\n    if (typeof p === 'object') {\n      // define parameter if not specified\n      p.type = p.type\n        ? p.type\n        : geomType === 'fill' || geomType === 'line'\n          ? 'path'\n          : 'html' in p || 'className' in p\n            ? 'icon'\n            : geomType;\n    }\n    opt.type = opt.type || geomType;\n  }\n  return opt;\n}\n","import { PropertiesFilter, Operations } from '../interfaces/LayerAdapter';\n\nfunction like(a: string, b: string, iLike?: boolean) {\n  const re = `^${a}$`.replace(/%/g, '.*').replace('_', '.');\n  return new RegExp(re, iLike ? 'i' : '').exec(b) !== null;\n}\n\nexport const operationsAliases: {\n  [key in Operations]: (a: any, b: any) => boolean;\n} = {\n  // greater(>)\n  gt: (a: any, b: any) => a > b,\n  // lower(<)\n  lt: (a: any, b: any) => a < b,\n  // greater or equal(>=)\n  ge: (a: any, b: any) => a >= b,\n  // lower or equal(<=)\n  le: (a: any, b: any) => a <= b,\n  // equal(=)\n  eq: (a: any, b: any) => a === b,\n  //  not equal(!=)\n  ne: (a: any, b: any) => a !== b,\n\n  in: (a: any, b: any[]) => b.indexOf(a) !== -1,\n  notin: (a: any, b: any[]) => b.indexOf(a) === -1,\n  // LIKE SQL statement(for strings compare)\n  like: (a: string, b: string) => {\n    return like(a, b);\n  },\n  // ILIKE SQL statement(for strings compare)\n  ilike: (a: string, b: string) => {\n    return like(a, b, true);\n  }\n};\n\nexport function propertiesFilter(\n  properties: { [field: string]: any },\n  filters: PropertiesFilter\n): boolean {\n  return filters.every(([field, operation, value]) => {\n    const operationExec = operationsAliases[operation];\n    const property = properties[field];\n    if (operationExec && property) {\n      return operationExec(property, value);\n    }\n    return true;\n  });\n}\n","import {\n  ToggleControlOptions,\n  ToggleControl,\n  ButtonControlOptions\n} from '../../interfaces/MapControl';\n\nexport function createToggleControl<C = any>(\n  createButtonControl: (options: ButtonControlOptions) => C,\n  options: ToggleControlOptions\n): C & ToggleControl {\n  const link = document.createElement('div');\n\n  let status = false;\n  if (options.getStatus) {\n    status = options.getStatus();\n  } else if (options.status) {\n    status = options.status;\n  }\n\n  const title = options.title || '';\n  const html = options.html;\n\n  function setTitle() {\n    if (title) {\n      if (typeof title === 'string') {\n        link.title = title;\n      } else {\n        link.title = status ? title.on : title.off;\n      }\n      link.setAttribute('aria-label', link.title);\n    }\n  }\n  setTitle();\n\n  // DomEvent.disableClickPropagation(link);\n  // DomEvent.on(link, 'click', DomEvent.stop);\n\n  function _setHtml(htmlDef: string | HTMLElement) {\n    if (htmlDef instanceof HTMLElement) {\n      link.innerHTML = '';\n      link.appendChild(htmlDef);\n    } else if (typeof htmlDef === 'string') {\n      link.innerHTML = htmlDef;\n    }\n  }\n  function setHtml() {\n    if (html) {\n      if (typeof html === 'string' || html instanceof HTMLElement) {\n        _setHtml(html);\n      } else {\n        _setHtml(status ? html.on : html.off);\n      }\n      link.setAttribute('aria-label', link.title);\n    }\n  }\n  setHtml();\n\n  function _setClass(addClass: string, impact: boolean) {\n    addClass.split(' ').forEach(x => {\n      if (impact) {\n        link.classList.add(x);\n      } else {\n        link.classList.remove(x);\n      }\n    });\n  }\n\n  function setClass() {\n    if (options.addClassOn) {\n      _setClass(options.addClassOn, status);\n    }\n    if (options.addClassOff) {\n      _setClass(options.addClassOff, !status);\n    }\n  }\n\n  if (options.addClass) {\n    _setClass(options.addClass, true);\n  }\n  setClass();\n\n  const changeStatus = (status_?: boolean) => {\n    if (status_ !== undefined) {\n      status = status_;\n    }\n    setHtml();\n    setTitle();\n    setClass();\n  };\n\n  const onClick = (status_?: boolean) => {\n    status = status_ !== undefined ? status_ : !status;\n    if (options.onClick) {\n      const afterClick = options.onClick(status);\n      Promise.resolve(afterClick)\n        .then(() => changeStatus())\n        .catch(() => (status = !status));\n    } else {\n      changeStatus();\n    }\n  };\n\n  const buttonControl = createButtonControl({\n    html: link,\n    onClick\n  }) as C & ToggleControl;\n  buttonControl.onClick = onClick;\n  buttonControl.changeStatus = changeStatus;\n  return buttonControl;\n}\n","export class KeyCodes {\n  'backspace' = 8;\n  'tab' = 9;\n  'enter' = 13;\n  'shift' = 16;\n  'ctrl' = 17;\n  'alt' = 18;\n  'pause/break' = 19;\n  'caps_lock' = 20;\n  'escape' = 27;\n  'page_up' = 33;\n  'page_down' = 34;\n  'end' = 35;\n  'home' = 36;\n  'left_arrow' = 37;\n  'up_arrow' = 38;\n  'right_arrow' = 39;\n  'down_arrow' = 40;\n  'insert' = 45;\n  'delete' = 46;\n  'left_window_key' = 91;\n  'right_window_key' = 92;\n  'select_key' = 93;\n  'numpad_0' = 96;\n  'numpad_1' = 97;\n  'numpad_2' = 98;\n  'numpad_3' = 99;\n  'numpad_4' = 100;\n  'numpad_5' = 101;\n  'numpad_6' = 102;\n  'numpad_7' = 103;\n  'numpad_8' = 104;\n  'numpad_9' = 105;\n  'multiply' = 106;\n  'add' = 107;\n  'subtract' = 109;\n  'decimal_point' = 110;\n  'divide' = 111;\n  'f1' = 112;\n  'f2' = 113;\n  'f3' = 114;\n  'f4' = 115;\n  'f5' = 116;\n  'f6' = 117;\n  'f7' = 118;\n  'f8' = 119;\n  'f9' = 120;\n  'f10' = 121;\n  'f11' = 122;\n  'f12' = 123;\n  'num_lock' = 144;\n  'scroll_lock' = 145;\n  'semi-colon' = 186;\n  'equal_sign' = 187;\n  ',' = 188; // \"comma\";\n  '-' = 189; // \"dash\";\n  '.' = 190; // \"period\";\n  '/' = 191; // \"forward slash\";\n  '`' = 192; // \"grave accent\";\n  '[' = 219; // \"open bracket\";\n  '\\\\' = 220; // \"back slash\";\n  ']' = 221; // \"close braket\";\n  \"'\" = 222; // \"single quote\"\n}\n","import { KeyCodes } from './KeysCodes';\n\n/**\n * @param {string} key - key symbol\n * @param {string} func - action on key press\n * @param {number} [keyCode] - key code for special button like tab\n *\n * @export\n * @interface KeyControl\n */\nexport interface KeyControl {\n  key?: string;\n  keyCode?: number;\n  func: () => void;\n}\n\nexport class Keys {\n  keyCodeAlias = new KeyCodes();\n\n  keys: { [keyCode: number]: boolean } = {};\n\n  private _windowOnFocus: () => void;\n  private _keysPressed: (e: KeyboardEvent) => void;\n  private _keysReleased: (e: KeyboardEvent) => void;\n\n  constructor() {\n    this._windowOnFocus = this.windowOnFocus.bind(this);\n    this._keysPressed = this.keysPressed.bind(this);\n    this._keysReleased = this.keysReleased.bind(this);\n    this.addKeyboardEventsListener();\n  }\n\n  pressed(keyName: keyof KeyCodes): boolean {\n    const code = this.keyCodeAlias[keyName];\n    return !!code && this.keys[code];\n  }\n\n  addKeyboardEventsListener() {\n    window.addEventListener('focus', this._windowOnFocus, false);\n    window.addEventListener('keydown', this._keysPressed, false);\n    window.addEventListener('keyup', this._keysReleased, false);\n  }\n\n  removeKeyboardEventsListener() {\n    window.removeEventListener('focus', this._windowOnFocus, false);\n    window.removeEventListener('keydown', this._keysPressed, false);\n    window.removeEventListener('keyup', this._keysReleased, false);\n  }\n\n  private keysPressed(e: KeyboardEvent) {\n    e.stopPropagation();\n    if (!this.keys[e.keyCode]) {\n      this.keys[e.keyCode] = true;\n    }\n  }\n\n  private keysReleased(e: KeyboardEvent) {\n    e.stopPropagation();\n    this.keys[e.keyCode] = false;\n  }\n\n  private windowOnFocus() {\n    this.keys = {};\n  }\n}\n","import { WebMap } from '../WebMap';\nimport { WebMapEvents } from '../interfaces/Events';\n\nexport function onLoad<E extends WebMapEvents = WebMapEvents>(event: keyof E) {\n  return function(\n    _target: WebMap,\n    _propertyKey: string,\n    descriptor: PropertyDescriptor\n  ) {\n    const originalMethod = descriptor.value;\n\n    descriptor.value = function(\n      this: WebMap<unknown, unknown, unknown, E>,\n      ...args: unknown[]\n    ) {\n      return new Promise((resolve, reject) => {\n        const _resolve = (): void => {\n          const origin = originalMethod.apply(this, args);\n          origin && origin.then\n            ? origin.then(resolve).catch(reject)\n            : resolve(origin);\n        };\n        const isLoaded = this.getEventStatus(event);\n        if (isLoaded) {\n          _resolve();\n        } else {\n          this.emitter.once(event as keyof WebMapEvents, () => {\n            _resolve();\n          });\n        }\n      });\n    };\n    return descriptor;\n  };\n}\n","import { MapStateItem } from '../../interfaces/MapState';\nimport { WebMapEvents } from '../../interfaces/Events';\nimport { WebMap } from '../../WebMap';\nimport { MapOptions } from '../../interfaces/WebMapApp';\n\nexport abstract class StateItem<V extends any | undefined = any | undefined>\n  implements MapStateItem<V | undefined> {\n  name!: keyof MapOptions;\n  event!: keyof WebMapEvents;\n  protected value?: V;\n\n  constructor(\n    protected webMap: WebMap,\n    opt?: { name?: keyof MapOptions; event?: keyof WebMapEvents; value?: V }\n  ) {\n    if (opt) {\n      if (opt.value) {\n        this.setValue(opt.value);\n      }\n      if (opt.name) {\n        this.name = opt.name;\n      }\n      if (opt.event) {\n        this.event = opt.event;\n      }\n    }\n  }\n\n  getValue() {\n    return this.value;\n  }\n\n  setValue(val: V) {\n    this.value = val;\n  }\n\n  abstract toString(data: any): string;\n  abstract parse(str: string): V;\n}\n","import { StateItem } from './StateItem';\nimport { WebMapEvents } from '../../interfaces/Events';\nimport { LngLatArray } from '../../interfaces/BaseTypes';\nimport { MapOptions } from '../../interfaces/WebMapApp';\n\nexport class CenterState extends StateItem<LngLatArray> {\n  name: keyof MapOptions = 'center';\n  event: keyof WebMapEvents = 'moveend';\n\n  getValue() {\n    return this.webMap.getCenter();\n  }\n  setValue(val: LngLatArray) {\n    this.webMap.setCenter(val);\n  }\n  toString(data: LngLatArray) {\n    const d = data.map(x => x.toFixed(5));\n    return d[0] + '_' + d[1];\n  }\n  parse(str: string) {\n    const lngLat = str.split('_').map(Number) as LngLatArray;\n    return lngLat;\n  }\n}\n","import { StateItem } from './StateItem';\nimport { WebMapEvents } from '../../interfaces/Events';\nimport { MapOptions } from '../../interfaces/WebMapApp';\n\nexport class ZoomState extends StateItem<number> {\n  name: keyof MapOptions = 'zoom';\n  event: keyof WebMapEvents = 'zoomend';\n  getValue() {\n    return this.webMap.getZoom();\n  }\n  setValue(val: number) {\n    this.webMap.setZoom(val);\n  }\n  toString(val: number) {\n    return String(val);\n  }\n  parse(str: string) {\n    return Number(str);\n  }\n}\n","/**\n * @module webmap\n */\nimport { deepmerge } from '@nextgis/utils';\nimport { GetPaintFunction } from './interfaces/LayerAdapter';\nimport { LayerAdapter } from './interfaces/LayerAdapter';\nimport {\n  MapAdapter,\n  FitOptions,\n  LocateOptions,\n  LocationEvents,\n  Locate\n} from './interfaces/MapAdapter';\nimport { MapOptions, AppOptions } from './interfaces/WebMapApp';\nimport {\n  LngLatBoundsArray,\n  Type,\n  Cursor,\n  LngLatArray\n} from './interfaces/BaseTypes';\nimport { RuntimeParams } from './interfaces/RuntimeParams';\nimport { StarterKit } from './interfaces/StarterKit';\n\nimport { createToggleControl } from './components/controls/ToggleControl';\n\nimport { Keys } from './components/keys/Keys';\n\nimport StrictEventEmitter from 'strict-event-emitter-types';\nimport { EventEmitter } from 'events';\nimport { WebMapEvents, BaseMapEvents } from './interfaces/Events';\n\nimport { onLoad } from './util/decorators';\nimport { propertiesFilter } from './util/propertiesFilter';\nimport { clearObject } from './util/clearObject';\n\nimport {\n  detectGeometryType,\n  findMostFrequentGeomType\n} from './util/geometryTypes';\nimport { updateGeoJsonAdapterOptions } from './util/updateGeoJsonAdapterOptions';\n\nimport { CenterState } from './components/mapStates/CenterState';\nimport { ZoomState } from './components/mapStates/ZoomState';\nimport { StateItem } from './components/mapStates/StateItem';\n\nconst OPTIONS: MapOptions = {\n  minZoom: 0,\n  maxZoom: 21,\n  paint: {\n    color: 'blue',\n    opacity: 1,\n    radius: 8,\n    weight: 1\n  },\n  selectedPaint: {\n    color: 'darkblue',\n    opacity: 1,\n    radius: 12,\n    weight: 1\n  }\n};\n\n/**\n * @class WebMap\n */\nexport class BaseWebMap<\n  M = any,\n  L = any,\n  C = any,\n  E extends WebMapEvents = WebMapEvents\n> {\n  static keys: Keys = new Keys();\n  static utils = {\n    detectGeometryType,\n    findMostFrequentGeomType,\n    updateGeoJsonAdapterOptions,\n    propertiesFilter,\n    createToggleControl\n  };\n  static getPaintFunctions: { [name: string]: GetPaintFunction };\n  static decorators = { onLoad };\n\n  options: MapOptions = OPTIONS;\n  // `WebMapEvents` must be `E` but its not work correct\n  readonly emitter: StrictEventEmitter<\n    EventEmitter,\n    WebMapEvents\n  > = new EventEmitter();\n  readonly keys = BaseWebMap.keys;\n\n  readonly mapAdapter: MapAdapter<M>;\n  readonly runtimeParams: RuntimeParams[] = [];\n\n  getPaintFunctions = BaseWebMap.getPaintFunctions;\n  mapState: Array<Type<StateItem>> = [CenterState, ZoomState];\n\n  /**\n   * From runtime params\n   */\n  protected _initMapState: Record<string, any> = {};\n  protected readonly _starterKits: StarterKit[];\n  private _mapState: StateItem[] = [];\n  private _extent?: LngLatBoundsArray;\n  private readonly _eventsStatus: { [key in keyof E]?: boolean } = {};\n\n  private readonly _mapEvents: Record<string, (...args: any[]) => void> = {};\n\n  constructor(appOptions: AppOptions) {\n    this.mapAdapter = appOptions.mapAdapter;\n    this._starterKits = appOptions.starterKits || [];\n    if (appOptions.mapOptions) {\n      this.options = deepmerge(OPTIONS || {}, appOptions.mapOptions);\n    }\n    if (appOptions.runtimeParams) {\n      this.runtimeParams = appOptions.runtimeParams;\n    }\n    this._addEventsListeners();\n    if (appOptions.create) {\n      this.create(this.options);\n    }\n  }\n\n  /**\n   * Manual way to create a map. On default\n   * @example\n   * ```javascript\n   * const webMap = new WebMap(options);\n   * webMap.create(mapOptions).then(() => doSomething());\n   * ```\n   */\n  async create(options?: MapOptions): Promise<this> {\n    if (!this.getEventStatus('create')) {\n      this.options = deepmerge(OPTIONS || {}, options);\n      await this._setInitMapState(this.mapState);\n      await this._setupMap();\n      this._emitStatusEvent('create', this);\n    }\n    return this;\n  }\n\n  setRuntimeParams(params: RuntimeParams) {\n    this.runtimeParams.push(params);\n  }\n\n  /**\n   * Destroys WebMap, MapAdapter, clears all layers and turn off all event listeners\n   */\n  destroy() {\n    this._removeEventsListeners();\n    clearObject(this._emitStatusEvent);\n    if (this.mapAdapter.destroy) {\n      this.mapAdapter.destroy();\n    }\n  }\n\n  getState(): Record<string, any> {\n    const state: Record<string, any> = {};\n    this._mapState.forEach(x => {\n      state[x.name] = x.getValue();\n    });\n    return state;\n  }\n\n  getRuntimeParams(): Record<string, any> {\n    const state: Record<string, any> = {};\n    this._mapState.forEach(x => {\n      for (const r of this.runtimeParams) {\n        const val = r.get(x.name);\n        if (val !== undefined) {\n          state[x.name] = x.parse(val);\n          break;\n        }\n      }\n    });\n    return state;\n  }\n\n  /**\n   * Returns the HTML element that contains the map.\n   * @returns The map's container\n   */\n  getContainer(): HTMLElement | undefined {\n    if (this.mapAdapter.getContainer) {\n      return this.mapAdapter.getContainer();\n    } else if (this.options.target) {\n      if (this.options.target instanceof HTMLElement) {\n        return this.options.target;\n      } else if (typeof this.options.target === 'string') {\n        const element = document.getElementById(this.options.target);\n        if (element) {\n          return element;\n        }\n      }\n    }\n  }\n\n  /**\n   * Set the cursor icon to be displayed when hover icon on the map container.\n   * @param cursor available cursor name from https://developer.mozilla.org/ru/docs/Web/CSS/cursor\n   */\n  setCursor(cursor: Cursor) {\n    if (this.mapAdapter.setCursor) {\n      this.mapAdapter.setCursor(cursor);\n    }\n  }\n\n  /**\n   * Set the center of the current view.\n   * @param lngLat Array of two numbers representing longitude and latitude of the center of the map view.\n   *\n   * @example\n   * ```javascript\n   * // Mount Everest 27° 59′ 17″ N, 86° 55′ 31″ E\n   * webMap.setCenter([86.925278, 27.988056]);\n   * ```\n   */\n  setCenter(lngLat: LngLatArray): this {\n    this.mapAdapter.setCenter(lngLat);\n    return this;\n  }\n\n  /**\n   * Returns the map's geographical centerpoint.\n   * @return lngLat Array of two numbers representing longitude and latitude of the center of the map view.\n   *\n   * @example\n   * ```javascript\n   * // Mount Everest 27° 59′ 17″ N, 86° 55′ 31″ E\n   * webMap.getCenter(); // [86.925278, 27.988056]\n   * ```\n   */\n  getCenter(): LngLatArray | undefined {\n    return this.mapAdapter.getCenter();\n  }\n\n  getBounds(): LngLatBoundsArray | undefined {\n    if (this.mapAdapter.getBounds) {\n      return this.mapAdapter.getBounds();\n    }\n  }\n\n  /**\n   * Zoom to a specific zoom level.\n   * @param zoom The zoom level to set (0-24).\n   */\n  setZoom(zoom: number): this {\n    this.mapAdapter.setZoom(zoom);\n    return this;\n  }\n\n  /**\n   * Returns the map's current zoom level.\n   * @return The map's current zoom level (0-24).\n   */\n  getZoom(): number | undefined {\n    return this.mapAdapter.getZoom();\n  }\n\n  /**\n   * Sets the view of the map geographical center and zoom\n   * @param lngLat Array of two numbers representing longitude and latitude of the center of the map view.\n   * @param zoom The zoom level to set (0-24).\n   *\n   * @example\n   * ```javascript\n   * // Mount Everest 27° 59′ 17″ N, 86° 55′ 31″ E\n   * webMap.setView([86.925278, 27.988056], 12)\n   * ```\n   */\n  setView(lngLat?: LngLatArray, zoom?: number) {\n    if (this.mapAdapter.setView && lngLat && zoom) {\n      this.mapAdapter.setView(lngLat, zoom);\n    } else {\n      if (lngLat) {\n        this.mapAdapter.setCenter(lngLat);\n      }\n      if (zoom) {\n        this.mapAdapter.setZoom(zoom);\n      }\n    }\n  }\n\n  /**\n   * Sets a map view that contains the given geographical bounds.\n   * @param bounds Array of coordinates, measured in degrees, in [west, south, east, north] order.\n   * @param options\n   *\n   * @example\n   * ```javascript\n   * // Whall world\n   * webMap.fitBounds([0, -90, 180, 90]);\n   * ```\n   */\n  fitBounds(bounds: LngLatBoundsArray, options?: FitOptions): this {\n    this.mapAdapter.fitBounds(bounds, options);\n    return this;\n  }\n\n  /**\n   * Checking the status of any asynchronous operation\n   * @param event The name of the event whose status is checked\n   *\n   * @example\n   * ```javascript\n   * var webMap = new WebMap(options);\n   * webMap.getEventStatus('create'); // false\n   * webMap.emitter.on('create', function () {\n   *   webMap.getEventStatus('create'); // true\n   * })\n   * ```\n   */\n  getEventStatus(event: keyof E): boolean {\n    // ugly hack to disable type checking error\n    const _eventName = event as keyof WebMapEvents;\n    const status = this._eventsStatus[_eventName];\n    return status !== undefined ? status : false;\n  }\n\n  /**\n   * helper method to wait for events to load. By default, card creation is tracked\n   * @param event The name of the event whose status is checked\n   *\n   * @example\n   * ```javascript\n   * var webMap = new WebMap(options);\n   * webMap.onLoad().then(function () {\n   *   webMap.getEventStatus('create'); // true\n   * })\n   *\n   * // use async/await syntax\n   * async function () {\n   *   await webMap.onLoad();\n   *   doSomething();\n   * }\n   *\n   * ```\n   */\n  onLoad(event: keyof WebMapEvents = 'create'): Promise<this> {\n    return new Promise(res => {\n      if (this.getEventStatus(event)) {\n        res(this);\n      } else {\n        this.emitter.once(event, () => {\n          res(this);\n        });\n      }\n    });\n  }\n\n  onMapLoad(cb?: (mapAdapter: MapAdapter) => void): Promise<MapAdapter> {\n    return new Promise(res => {\n      const _resolve = () => {\n        const mapAdapter = this.mapAdapter;\n        if (cb) {\n          cb(mapAdapter);\n        }\n        if (mapAdapter) {\n          res(mapAdapter);\n        }\n      };\n      const isLoaded =\n        this.mapAdapter.isLoaded !== undefined\n          ? this.mapAdapter.isLoaded\n          : true;\n      if (this.mapAdapter.map && isLoaded) {\n        _resolve();\n      } else {\n        this.mapAdapter.emitter.once('create', () => {\n          _resolve();\n        });\n      }\n    });\n  }\n\n  getLayerAdapters(): { [name: string]: Type<LayerAdapter> } {\n    return this.mapAdapter.layerAdapters;\n  }\n\n  getLayerAdapter(name: string): Type<LayerAdapter> {\n    const adapter = this.mapAdapter.layerAdapters[name];\n    return adapter;\n  }\n\n  locate(opt: LocateOptions, events?: LocationEvents): Locate {\n    if (this.mapAdapter && this.mapAdapter.locate) {\n      return this.mapAdapter.locate(opt, events);\n    }\n    const stop = () => ({});\n    return { stop };\n  }\n\n  protected _emitStatusEvent(eventName: keyof E, data?: any) {\n    // ugly hack to disable type checking error\n    const _eventName = eventName as keyof WebMapEvents;\n    this._eventsStatus[_eventName] = true;\n    this.emitter.emit(_eventName, data);\n  }\n\n  protected async _addLayerProviders(): Promise<void> {\n    //\n  }\n\n  protected async _onLoadSync(): Promise<void> {\n    //\n  }\n\n  private async _setupMap() {\n    await this.mapAdapter.create(this.options);\n    this._zoomToInitialExtent();\n\n    await this._addLayerProviders();\n    await this._onLoadSync();\n\n    this._emitStatusEvent('build-map', this.mapAdapter);\n    return this;\n  }\n\n  private _zoomToInitialExtent() {\n    const { center, zoom, bounds } = this.options;\n    if (this._extent) {\n      this.fitBounds(this._extent);\n    } else if (center && zoom) {\n      this.setView(center, zoom);\n    } else if (bounds) {\n      this.fitBounds(bounds);\n    }\n  }\n\n  private _setInitMapState(states: Type<StateItem>[]) {\n    for (const X of states) {\n      const state = new X(this);\n      this._mapState.push(state);\n      for (const r of this.runtimeParams) {\n        const str = r.get(state.name);\n        if (str !== undefined) {\n          const val = state.parse(str);\n          // state.setValue(val);\n          this._initMapState[state.name] = val;\n          this.options[state.name] = val;\n          break;\n        }\n      }\n    }\n  }\n\n  private _addEventsListeners(): void {\n    const events: Array<keyof BaseMapEvents> = [\n      'click',\n      'zoomstart',\n      'zoom',\n      'zoomend',\n      'movestart',\n      'move',\n      'moveend'\n    ];\n    events.forEach(x => {\n      this._mapEvents[x] = data => {\n        if (this.runtimeParams.length) {\n          const mapStatusEvent = this._mapState.find(y => y.event === x);\n          if (mapStatusEvent) {\n            const value = mapStatusEvent.toString(mapStatusEvent.getValue());\n            this.runtimeParams.forEach(r => {\n              r.set(mapStatusEvent.name, value);\n            });\n          }\n        }\n        if (this._eventsStatus) {\n          this.emitter.emit(x, data);\n        }\n      };\n      this.mapAdapter.emitter.on(x, this._mapEvents[x]);\n    });\n  }\n\n  private _removeEventsListeners(): void {\n    Object.entries(this._mapEvents).forEach(([x, event]) => {\n      this.mapAdapter.emitter.off(x, event);\n    });\n  }\n}\n","export function clearObject(obj: Record<any, any>): void {\n  for (const member in obj) {\n    delete obj[member];\n  }\n}\n","/**\n * @module webmap\n */\nimport {\n  LayerAdapter,\n  LayerAdapters,\n  AdapterConstructor,\n  LayerAdaptersOptions,\n  AdapterOptions,\n  GeoJsonAdapterOptions,\n  VectorLayerAdapter,\n  DataLayerFilter,\n  OnLayerClickOptions,\n  PropertiesFilter,\n  FilterOptions,\n  LayerDefinition\n} from './interfaces/LayerAdapter';\nimport { LayerDef, Type } from './interfaces/BaseTypes';\n\nimport { Feature, GeoJsonObject } from 'geojson';\nimport { preparePaint } from './util/preparePaint';\nimport { updateGeoJsonAdapterOptions } from './util/updateGeoJsonAdapterOptions';\nimport {\n  GetAttributionsOptions,\n  ToggleLayerOptions\n} from './interfaces/WebMapApp';\nimport { propertiesFilter } from './util/propertiesFilter';\nimport { BaseWebMap } from './BaseWebMap';\nimport { WebMapEvents } from './interfaces/Events';\n\nexport class WebMapLayers<\n  M = any,\n  L = any,\n  C = any,\n  E extends WebMapEvents = WebMapEvents\n> extends BaseWebMap<M, L, C, E> {\n  private _layersIds = 1;\n  private readonly _baseLayers: string[] = [];\n  private readonly _layers: { [id: string]: LayerAdapter } = {};\n  private readonly _selectedLayers: string[] = [];\n\n  /**\n   * Try to fit map view by given layer bounds.\n   * But not all layers have borders\n   * @param layerDef\n   */\n  async fitLayer(layerDef: LayerDef) {\n    const layer = this.getLayer(layerDef);\n    if (layer && layer.getExtent) {\n      const extent = await layer.getExtent();\n      if (extent) {\n        this.fitBounds(extent);\n      }\n    }\n  }\n\n  /**\n   * Check if given layer is baselayer\n   * @param layerName Check\n   */\n  isBaseLayer(layerDef: LayerDef): boolean | undefined {\n    const layer = this.getLayer(layerDef);\n    if (layer && layer.id) {\n      return this._baseLayers.indexOf(layer.id) !== -1;\n    }\n    return undefined;\n  }\n\n  getBaseLayers() {\n    return this._baseLayers;\n  }\n\n  /**\n   * Helper method to return added layer object by any definition type.\n   */\n  getLayer<LA extends LayerAdapter = LayerAdapter>(\n    layerDef: LayerDef\n  ): LA | undefined {\n    if (typeof layerDef === 'string') {\n      return this._layers[layerDef] as LA;\n    }\n    return layerDef as LA;\n  }\n\n  /**\n   * Helper method to return added layer identificator by any definition type.\n   */\n  getLayerId(layerDef: LayerDef): string | undefined {\n    const layer = this.getLayer(layerDef);\n    if (layer && layer.options) {\n      return layer.options.id;\n    } else {\n      throw new Error('No id for layer');\n    }\n  }\n\n  /**\n   * Return array of all added layer identificators.\n   */\n  getLayers(): string[] {\n    return Object.keys(this._layers);\n  }\n\n  findLayer<T extends LayerAdapter = LayerAdapter>(\n    filter: (adapter: T) => boolean\n  ): T | undefined {\n    for (const l in this._layers) {\n      const layerAdapter = this._layers[l] as T;\n      const isFit = filter(layerAdapter);\n      if (isFit) {\n        return layerAdapter;\n      }\n    }\n  }\n\n  /**\n   * Check if the given layer on the map\n   */\n  isLayerVisible(layerDef: LayerDef): boolean {\n    const layer = this.getLayer(layerDef);\n    return layer && layer.options.visibility !== undefined\n      ? layer.options.visibility\n      : false;\n  }\n\n  /**\n   * Shortcut method to create base layer\n   * @param adapter\n   * @param options\n   */\n  async addBaseLayer<\n    K extends keyof LayerAdapters,\n    O extends AdapterOptions = AdapterOptions\n  >(\n    adapter: K | Type<LayerAdapters[K]>,\n    options: O | LayerAdaptersOptions[K]\n  ): Promise<LayerAdapter> {\n    const layer = await this.addLayer(adapter, {\n      ...options,\n      baseLayer: true\n    });\n\n    return layer;\n  }\n\n  /**\n   * Registration of map layer.\n   *\n   * @param adapter The name of layer adapter from [MapAdapter.layerAdapters](webmap#MapAdapter.layerAdapters).\n   *                May be custom object or class implemented by [BaseLayerAdapter](webmap#BaseLayerAdapter).\n   * @param options Specific options for given adapter\n   *\n   * @example\n   * ```javascript\n   * webMap.addLayer('TILE', options).then((layer) => webMap.showLayer(layer));\n   *\n   * webMap.addLayer(CustomLayerAdapter, options);\n   * ```\n   */\n  async addLayer<\n    K extends keyof LayerAdapters,\n    O extends AdapterOptions = AdapterOptions\n  >(\n    adapter:\n      | K\n      | Type<LayerAdapters[K]>\n      | Promise<Type<LayerAdapters[K]> | undefined>,\n    options: O | LayerAdaptersOptions[K],\n    order?: number\n  ): Promise<LayerAdapter> {\n    const _order = order || this._layersIds++;\n    let adapterEngine: Type<LayerAdapter> | undefined;\n    if (typeof adapter === 'string') {\n      adapterEngine = this.getLayerAdapter(adapter);\n    } else if (typeof adapter === 'function') {\n      adapterEngine = adapter as Type<LayerAdapter>;\n    } else if (\n      'then' in (adapter as Promise<Type<LayerAdapters[K]> | undefined>)\n    ) {\n      adapterEngine = (await adapter) as Type<LayerAdapters[K]>;\n    }\n\n    const geoJsonOptions = options as GeoJsonAdapterOptions;\n\n    this._updateGeoJsonOptions(geoJsonOptions);\n\n    const { maxZoom, minZoom } = this.options;\n\n    options = {\n      id: String(_order),\n      order: _order,\n      maxZoom,\n      minZoom,\n      ...options\n    };\n    // options.visibility is a layer global state, but each layer on init is not visible\n    const visibility = options.visibility;\n    options.visibility = false;\n\n    // TODO: check usage in adapter constructor and safe remove\n    if (options.baseLayer) {\n      options.order = 0;\n    }\n    if (this.options.onBeforeAddLayer) {\n      const modified = this.options.onBeforeAddLayer({\n        options,\n        adapter: adapterEngine\n      });\n      if (modified) {\n        if (modified.options) {\n          options = modified.options;\n        }\n        if (modified.adapter) {\n          adapterEngine = modified.adapter;\n        }\n      }\n    }\n    if (adapterEngine !== undefined) {\n      const _adapter = new adapterEngine(this.mapAdapter.map, options);\n      if (_adapter.options.baseLayer) {\n        options.baseLayer = true;\n        options.order = 0;\n      }\n\n      let layerId = _adapter.options.id;\n      if (layerId) {\n        this._layers[layerId] = _adapter;\n      }\n      this.emitter.emit('layer:preadd', _adapter);\n      await this.onMapLoad();\n      const layer = await _adapter.addLayer(options);\n      // checking that the original layer was inserted into the adapter anyway\n      _adapter.layer = layer;\n      // think about how to move `id` to the adapter's constructor,\n      // but that it is not required in the options\n      _adapter.id = _adapter.options.id;\n\n      layerId = _adapter.options.id;\n      if (layerId) {\n        if (geoJsonOptions.filter) {\n          this.filterLayer(_adapter, geoJsonOptions.filter);\n        }\n        if (options.baseLayer) {\n          this._baseLayers.push(layerId);\n        }\n        this._layers[layerId] = _adapter;\n\n        if (visibility) {\n          this.showLayer(layerId);\n        }\n      }\n      const opacity = options.opacity;\n      if (opacity !== undefined && opacity <= 1) {\n        this.setLayerOpacity(_adapter, opacity);\n      }\n      if (options.fit && _adapter.getExtent) {\n        const extent = await _adapter.getExtent();\n        if (extent) {\n          await this.fitBounds(extent);\n        }\n      }\n      this.emitter.emit('layer:add', _adapter);\n      return _adapter;\n    }\n    return Promise.reject('No adapter');\n  }\n\n  async addLayerFromAsyncAdapter<\n    K extends keyof LayerAdapters,\n    O extends AdapterOptions = AdapterOptions\n  >(\n    adapter: AdapterConstructor,\n    options: O | LayerAdaptersOptions[K],\n    order?: number\n  ): Promise<LayerAdapter> {\n    const _order = order || this._layersIds++;\n    const adapterConstructor = adapter as AdapterConstructor;\n    const adapterConstructorPromise = adapterConstructor();\n    const adapterEngine = await adapterConstructorPromise;\n    if (adapterEngine) {\n      return this.addLayer(adapterEngine, options, _order);\n    }\n    return Promise.reject('No adapter');\n  }\n\n  /**\n   * Remove all layer from map and memory.\n   */\n  removeLayers(allowCb?: (layer: string, adapter: LayerAdapter) => boolean) {\n    for (const l in this._layers) {\n      let allow = true;\n      if (allowCb) {\n        allow = allowCb(l, this._layers[l]);\n      }\n      if (allow) {\n        this.removeLayer(l);\n        delete this._layers[l];\n      }\n    }\n  }\n\n  /**\n   * Remove all layers but not remove basemap.\n   */\n  removeOverlays() {\n    this.removeLayers((layerId, layer) => !layer.options.baseLayer);\n  }\n\n  /**\n   * Remove specific layer from map and memory by its definition.\n   * @param layerDef\n   */\n  removeLayer(layerDef: LayerDef) {\n    const layer = this.getLayer(layerDef);\n    const layerId = layer && this.getLayerId(layer);\n    if (layer && layerId) {\n      this.emitter.emit('layer:preremove', layer);\n      if (layer.beforeRemove) {\n        layer.beforeRemove();\n      }\n      if (layer.beforeRemove) {\n        layer.beforeRemove();\n      }\n      if (layer.removeLayer) {\n        layer.removeLayer();\n      } else {\n        this.mapAdapter.removeLayer(layer.layer);\n      }\n      if (layer.options && layer.options.baseLayer) {\n        const index = this._baseLayers.indexOf(layerId);\n        if (index) {\n          this._baseLayers.splice(index, 1);\n        }\n      }\n      delete this._layers[layerId];\n      this.emitter.emit('layer:remove', layer);\n    }\n  }\n\n  /**\n   * Create layer from GeoJson data. Set style and behavior for selection.\n   *\n   * @example\n   * ```javascript\n   * // Add simple layer\n   * webMap.addGeoJsonLayer({ data: geojson, paint: { color: 'red' } });\n   *\n   * // Add styled by feature property layer with selection behavior\n   * webMap.addGeoJsonLayer({\n   *   data: geojson,\n   *   paint: function (feature) {\n   *     return { color: feature.properties.color, opacity: 0.5 }\n   *   },\n   *  selectedPaint: function (feature) {\n   *    return { color: feature.properties.selcolor, opacity: 1 }\n   *  },\n   *  selectable: true,\n   *  multiselect: true\n   * });\n   *\n   * // Add marker layer styled with use [Icons](icons)\n   * webMap.addGeoJsonLayer({ data: geojson, paint: webMap.getIcon({ color: 'orange' })});\n   *\n   * // work with added layer\n   * const layer = webMap.addGeoJsonLayer({ data: geojson, id: 'my_layer_name'});\n   * // access layer by id\n   * webMap.showLayer('my_layer_name');\n   * // or access layer by instance\n   * webMap.showLayer(layer);\n   * ```\n   */\n  // @onMapLoad()\n  async addGeoJsonLayer<K extends keyof LayerAdaptersOptions>(\n    opt: GeoJsonAdapterOptions,\n    adapter?: K | Type<LayerAdapter>\n  ) {\n    opt = opt || {};\n    opt.multiselect = opt.multiselect !== undefined ? opt.multiselect : false;\n    opt.unselectOnSecondClick =\n      opt.unselectOnSecondClick !== undefined\n        ? opt.unselectOnSecondClick\n        : true;\n    if (!adapter) {\n      opt = updateGeoJsonAdapterOptions(opt);\n    }\n    opt.paint = opt.paint || {};\n    const layer = await this.addLayer(adapter || 'GEOJSON', opt);\n    this.showLayer(layer);\n    return layer;\n  }\n\n  /**\n   * Show added layer on the map by it definition.\n   */\n  showLayer(layerDef: LayerDef, options: ToggleLayerOptions = {}) {\n    this.toggleLayer(layerDef, true, options);\n  }\n\n  /**\n   * Hide added layer on the map by it definition.\n   */\n  hideLayer(layerDef: LayerDef, options: ToggleLayerOptions = {}) {\n    this.toggleLayer(layerDef, false, options);\n  }\n\n  /**\n   * Change added layer visibility on the map by given status or inverse current status.\n   *\n   * @example\n   * ```javascript\n   * webMap.addLayer('TILE', {id: 'my_layer', url: ''}).then((layer) => {\n   *   webMap.toggleLayer(layer, true);\n   *   webMap.toggleLayer('my_layer', false);\n   *   webMap.toggleLayer('my_layer');\n   *   webMap.isLayerVisible(layer); // true\n   * });\n   * ```\n   */\n  toggleLayer(\n    layerDef: LayerDef,\n    status?: boolean,\n    options: ToggleLayerOptions = {}\n  ) {\n    const layer = this.getLayer(layerDef);\n    const onMap = layer && layer.options.visibility;\n    const toStatus = status !== undefined ? status : !onMap;\n    const silent = options.silent !== undefined ? options.silent : false;\n    const action = (source: any, l: LayerAdapter) => {\n      l.options.visibility = toStatus;\n\n      const preEventName = toStatus ? 'layer:preshow' : 'layer:prehide';\n      const eventName = toStatus ? 'layer:show' : 'layer:hide';\n      if (!silent) {\n        this.emitter.emit(preEventName, l);\n      }\n      if (toStatus && source) {\n        const order = l.options.baseLayer ? 0 : l.options.order;\n\n        // do not show baselayer if another on the map\n        if (order === 0 && this._baseLayers.length) {\n          const anotherVisibleLayerBaseLayer = this._baseLayers.find(x => {\n            return x !== l.id && this.isLayerVisible(x);\n          });\n          if (anotherVisibleLayerBaseLayer) {\n            this.hideLayer(anotherVisibleLayerBaseLayer);\n          }\n        }\n\n        if (l.showLayer) {\n          l.showLayer.call(l, l.layer);\n        } else {\n          this.mapAdapter.showLayer(l.layer);\n        }\n        if (order !== undefined) {\n          this.mapAdapter.setLayerOrder(l.layer, order, this._layers);\n        }\n      } else {\n        if (l.hideLayer) {\n          l.hideLayer.call(l, l.layer);\n        } else {\n          this.mapAdapter.hideLayer(l.layer);\n        }\n      }\n      if (!silent) {\n        this.emitter.emit(eventName, l);\n      }\n    };\n    if (layer && layer.options.visibility !== toStatus) {\n      if (this.mapAdapter.map) {\n        action(this.mapAdapter, layer);\n      } else {\n        this.mapAdapter.emitter.once('create', adapter => {\n          action(adapter.map, layer);\n        });\n      }\n    }\n  }\n\n  updateLayer(layerDef: LayerDef) {\n    const layer = this.getLayer(layerDef);\n    if (layer) {\n      if (layer.updateLayer) {\n        layer.updateLayer();\n      } else if (this.isLayerVisible(layer)) {\n        this.hideLayer(layer, { silent: true });\n        this.showLayer(layer, { silent: true });\n      }\n    }\n  }\n\n  /**\n   * Set transparency for a given layer by number from 0 to 1\n   */\n  setLayerOpacity(layerDef: LayerDef, value: number) {\n    const layer = this.getLayer(layerDef);\n    if (layer) {\n      if (this.mapAdapter.setLayerOpacity) {\n        if (layer) {\n          this.mapAdapter.setLayerOpacity(layer.layer, value);\n        }\n      }\n    }\n  }\n\n  // requestGeomString(pixel: Pixel, pixelRadius: number) {\n  //   if (this.mapAdapter.requestGeomString) {\n  //     return this.mapAdapter.requestGeomString(pixel, pixelRadius);\n  //   }\n  // }\n\n  /**\n   * Mark the layer as selected.\n   * If the adapter is a vector layer and supports data selection,\n   * you can pass a callback function to specify which data will be selected.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON', {data: geojson}).then((layer) => {\n   *   webMap.selectLayer(layer, ({feature}) => feature.id === '42');\n   * });\n   * ```\n   * @param layerDef\n   * @param findFeatureFun\n   */\n  selectLayer(layerDef: LayerDef, findFeatureFun?: DataLayerFilter) {\n    const layer = this.getLayer(layerDef);\n    if (layer) {\n      const adapter = layer as VectorLayerAdapter;\n      if (adapter && adapter.select) {\n        adapter.select(findFeatureFun);\n      }\n      const layerId = this.getLayerId(layer);\n      if (layerId) {\n        this._selectedLayers.push(layerId);\n      }\n    }\n  }\n\n  /**\n   * Unselect the given layer.\n   * If the adapter is a vector layer and supports data selection,\n   * you can pass a callback function to specify which data will be unselected.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON', {data: geojson}).then((layer) => {\n   *   webMap.unSelectLayer(layer, ({feature}) => feature.id === '42');\n   * });\n   * ```\n   *\n   * @param layerDef\n   * @param findFeatureFun\n   */\n  unSelectLayer(layerDef: LayerDef, findFeatureFun?: DataLayerFilter) {\n    const layer = this.getLayer(layerDef);\n    if (layer) {\n      const adapter = layer && (layer as VectorLayerAdapter);\n      if (adapter.unselect) {\n        adapter.unselect(findFeatureFun);\n      }\n      const layerId = this.getLayerId(layer);\n      if (layerId) {\n        const index = this._selectedLayers.indexOf(layerId);\n        if (index !== -1) {\n          this._selectedLayers.splice(index, 1);\n        }\n      }\n    }\n  }\n\n  /**\n   * Hide features from a vector layer using a callback function.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON', {data: geojson}).then((layer) => {\n   *   webMap.filterLayer(layer, ({feature}) => feature.id === '42');\n   * });\n   * ```\n   *\n   * @param layerDef\n   * @param filter\n   */\n  filterLayer(\n    layerDef: LayerDef,\n    filter: DataLayerFilter<Feature, L>\n  ): LayerDefinition<Feature, L>[] {\n    const layer = this.getLayer(layerDef);\n    const adapter = layer as VectorLayerAdapter;\n    if (adapter.filter) {\n      return adapter.filter(filter);\n    }\n    return [];\n  }\n\n  propertiesFilter(\n    layerDef: LayerDef,\n    filters: PropertiesFilter,\n    options?: FilterOptions\n  ) {\n    const layer = this.getLayer(layerDef);\n    const adapter = layer as VectorLayerAdapter;\n    if (adapter.propertiesFilter) {\n      adapter.propertiesFilter(filters, options);\n    } else if (adapter.filter) {\n      this.filterLayer(adapter, e => {\n        if (e.feature && e.feature.properties) {\n          return propertiesFilter(e.feature.properties, filters);\n        }\n        return true;\n      });\n    }\n  }\n\n  removeLayerFilter(layerDef: LayerDef) {\n    const layer = this.getLayer(layerDef);\n    const adapter = layer as VectorLayerAdapter;\n    if (adapter.removeFilter) {\n      adapter.removeFilter();\n    } else if (adapter.filter) {\n      adapter.filter(() => {\n        return true;\n      });\n    }\n  }\n\n  /**\n   * Sets the GeoJSON data for given vector layer.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON').then((layer) => {\n   *   webMap.setLayerData(layer, geojson);\n   * });\n   * ```\n   */\n  setLayerData(layerDef: LayerDef, data: GeoJsonObject) {\n    const vectorAdapter = this.getLayer(layerDef);\n    const adapter = vectorAdapter as VectorLayerAdapter;\n    if (adapter) {\n      if (adapter.setData) {\n        adapter.setData(data);\n      } else if (adapter.clearLayer && adapter.addData) {\n        adapter.clearLayer();\n        adapter.addData(data);\n      }\n    }\n  }\n\n  /**\n   * Push new the GeoJSON features into given vector layer.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON', {data: geojson_features_5}).then((layer) => {\n   *   console.log(layer.getLayers().length) // > 5;\n   *   webMap.addLayerData(layer, geojson_features_3);\n   *   console.log(layer.getLayers().length) // > 8;\n   * });\n   * ```\n   */\n  addLayerData(layerDef: LayerDef, data: GeoJsonObject) {\n    const layerMem = this.getLayer(layerDef);\n    const adapter = layerMem as VectorLayerAdapter;\n    if (adapter.addData) {\n      adapter.addData(data);\n    }\n  }\n\n  /**\n   * Remove from vector layer all features.\n   * it is possible to remove only some objects if you specify a callback function.\n   *\n   * @example\n   * ```javascript\n   * const layer = webMap.addLayer('GEOJSON', {data: geojson}).then((layer) => {\n   *   webMap.clearLayerData(layer, (feture) => feture.id === 42);\n   *   webMap.clearLayerData(layer);\n   * });\n   * ```\n   */\n  clearLayerData(layerDef: LayerDef, cb?: (feature: Feature) => boolean) {\n    const layerMem = this.getLayer(layerDef);\n    const adapter = layerMem as VectorLayerAdapter;\n    if (adapter && adapter.clearLayer) {\n      adapter.clearLayer(cb);\n    }\n  }\n\n  getAttributions(options: GetAttributionsOptions): string[] {\n    const attributions: string[] = [];\n    for (const l in this._layers) {\n      const layerMem = this._layers[l];\n      const onlyVisible =\n        options.onlyVisible !== undefined ? options.onlyVisible : true;\n      const useLayerAttr = onlyVisible ? layerMem.options.visibility : true;\n      if (useLayerAttr) {\n        const attr = layerMem.options && layerMem.options.attribution;\n        if (attr) {\n          attributions.push(attr);\n        }\n      }\n    }\n\n    return attributions;\n  }\n\n  getActiveBaseLayer() {\n    const visibleLayerBaseLayer = this.getBaseLayers().find(x => {\n      return this.isLayerVisible(x);\n    });\n    if (visibleLayerBaseLayer) {\n      return this.getLayer(visibleLayerBaseLayer);\n    }\n  }\n\n  private async _onLayerClick(options: OnLayerClickOptions) {\n    this.emitter.emit('layer:click', options);\n    return Promise.resolve(options);\n  }\n\n  private _updateGeoJsonOptions(options: GeoJsonAdapterOptions) {\n    const onLayerClickFromOpt = options.onLayerClick;\n    options.onLayerClick = e => {\n      if (onLayerClickFromOpt) {\n        onLayerClickFromOpt(e);\n      }\n      return this._onLayerClick(e);\n    };\n    if (!options.nativePaint) {\n      if (this.options.paint) {\n        options.paint = preparePaint(\n          options.paint || {},\n          this.options.paint,\n          this.getPaintFunctions\n        );\n      }\n      if (options.selectedPaint && this.options.selectedPaint) {\n        options.selectedPaint = preparePaint(\n          options.selectedPaint,\n          this.options.selectedPaint,\n          this.getPaintFunctions\n        );\n      }\n    }\n  }\n}\n","/**\n * @module webmap\n *\n * Since it was not possible to split the code through mixins, inheritance was used.\n * The `ts-mixin` plugin worked fine, but led to errors in IE.\n *\n * Now inheritance is as follow:\n * BaseWebMap > WebMapLayers > WebMap\n *\n * Will need to be done this way:\n * class WebMap extend mixin(WebMapLayers, WebMapControls) {}\n *\n * This approach can also be considered\n *\n * class WebMap {\n *   layers: WebMapLayers;\n *   controls  WebMapControls\n * }\n *\n * and then\n *\n * const webMap = new WebMap(...);\n * webMap.layers.addLayer(...)\n *\n * looks good, but will add difficulty in inheriting from WebMap\n *\n * old:\n *\n * class NgwMap extends WebMap {\n *   addLayer(...) {\n *      super.addLayer(...)\n *   }\n * }\n *\n * new:\n *\n * class NgwLayers extends WebMapLayers {\n *   addLayer(...) {\n *     super.addLayer(...)\n *   }\n * }\n *\n * class NgwMap extends WebMap {\n *   layersClass = NgwLayers\n * }\n *\n * ...and there will be compatibility issues\n *\n */\n\nimport { WebMapEvents } from './interfaces/Events';\n\nimport {\n  MapControl,\n  CreateControlOptions,\n  ButtonControlOptions,\n  ToggleControlOptions,\n  ToggleControl,\n  MapControls\n} from './interfaces/MapControl';\n\nimport { ControlPositions } from './interfaces/MapAdapter';\nimport { WebMapLayers } from './WebMapLayers';\n\nexport class WebMap<\n  M = any,\n  L = any,\n  C = any,\n  E extends WebMapEvents = WebMapEvents\n> extends WebMapLayers<M, L, C, E> {\n  static controls: {\n    [name: string]: (webMap: WebMap, options?: any) => any;\n  } = {\n    CONTROL: (\n      webMap: WebMap,\n      options: {\n        control: MapControl;\n        options?: CreateControlOptions;\n      }\n    ) => {\n      return webMap.createControl(options.control, options.options);\n    },\n    BUTTON: (webMap: WebMap, options: ButtonControlOptions) => {\n      return webMap.createButtonControl(options);\n    },\n    TOGGLE: (webMap: WebMap, options: ToggleControlOptions) => {\n      return webMap.createToggleControl(options);\n    }\n  };\n\n  async addControl<K extends keyof MapControls>(\n    controlDef: K | C,\n    position: ControlPositions,\n    options?: MapControls[K]\n  ): Promise<any> {\n    let control: C | undefined;\n    if (typeof controlDef === 'string') {\n      control = this.getControl(controlDef, options);\n    } else {\n      control = controlDef as C;\n    }\n    if (control) {\n      const _control = await control;\n      return this.mapAdapter.addControl(_control, position);\n    }\n  }\n\n  /**\n   * Creating a universal map layout control element. Can be used with any map adapter.\n   *\n   * @example\n   * const control = webMap.createControl({\n   *   onAdd() {\n   *     return document.createElement('div');\n   *   }\n   * });\n   */\n  async createControl(\n    control: MapControl,\n    options?: CreateControlOptions\n  ): Promise<C | undefined> {\n    await this.onLoad('build-map');\n    if (this.mapAdapter.createControl) {\n      return this.mapAdapter.createControl(control, options);\n    }\n  }\n\n  async createButtonControl(\n    options: ButtonControlOptions\n  ): Promise<C | undefined> {\n    await this.onLoad('build-map');\n    if (this.mapAdapter.createButtonControl) {\n      return this.mapAdapter.createButtonControl(options);\n    }\n  }\n\n  async createToggleControl(\n    options: ToggleControlOptions\n  ): Promise<(C & ToggleControl) | undefined> {\n    await this.onLoad('build-map');\n    if (this.mapAdapter.createToggleControl) {\n      return this.mapAdapter.createToggleControl(options);\n    } else {\n      if (this.mapAdapter.createButtonControl) {\n        return WebMap.utils.createToggleControl<C>(\n          this.mapAdapter.createButtonControl,\n          options\n        );\n      }\n    }\n  }\n\n  removeControl(control: any) {\n    if (control.remove) {\n      control.remove();\n    } else if (this.mapAdapter.removeControl) {\n      this.mapAdapter.removeControl(control);\n    }\n  }\n\n  getControl<K extends keyof MapControls>(\n    control: K,\n    options?: MapControls[K]\n  ): C | undefined {\n    const engine = this.mapAdapter.controlAdapters[control];\n    if (engine) {\n      return new engine(options);\n    } else {\n      const createFun = WebMap.controls[control];\n      if (createFun) {\n        return createFun(this, options);\n      }\n    }\n  }\n\n  protected async _addLayerProviders(): Promise<void> {\n    try {\n      for await (const kit of this._starterKits) {\n        if (kit.getLayerAdapters) {\n          const adapters = await kit.getLayerAdapters.call(kit);\n          if (adapters) {\n            for await (const adapter of adapters) {\n              const newAdapter = await adapter.createAdapter(this);\n              if (newAdapter) {\n                this.mapAdapter.layerAdapters[adapter.name] = newAdapter;\n              }\n            }\n          }\n        }\n      }\n    } catch (er) {\n      throw new Error(er);\n    }\n  }\n\n  protected async _onLoadSync(): Promise<void> {\n    for await (const kit of this._starterKits) {\n      if (kit.onLoadSync) {\n        try {\n          await kit.onLoadSync.call(kit, this);\n        } catch (er) {\n          console.error(er);\n        }\n      }\n    }\n  }\n}\n","/**\n * @module webmap\n * @preferred\n */\n\nimport { WebMap } from './WebMap';\n\nexport * from './WebMap';\nexport * from './WebMapLayers';\nexport * from './interfaces/BaseTypes';\nexport * from './interfaces/WebMapApp';\nexport * from './interfaces/MapAdapter';\nexport * from './interfaces/DialogAdapter';\nexport * from './interfaces/MapControl';\nexport * from './interfaces/LayerAdapter';\nexport * from './interfaces/StarterKit';\nexport * from './interfaces/RuntimeParams';\nexport * from './interfaces/Events';\n\nexport { WebMap };\nexport default WebMap;\n"],"sourceRoot":""}